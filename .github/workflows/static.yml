name: Sync File to Public Repository

on:
  schedule:
    - cron: '*/5 * * * *'  # Adjust the cron schedule as needed
  workflow_dispatch:

jobs:
  sync-file:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout private repository
      uses: actions/checkout@v2

    - name: Set up Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '16'  # Specify the version of Node.js you need

    - name: Install dependencies
      run: |
        npm install node-fetch  # Install the necessary dependencies

    - name: Run script
      run: |
        node run.js  # Ensure the script is using dynamic import or ES Module syntax

    - name: Clone public repository
      run: |
        git clone https://github.com/Siva2webdev/TataplayAuto.git

    - name: Copy output file to public repository
      run: |
        cp ts.m3u TataplayAuto/  # Replace output_file.txt with your file name

    - name: Commit and push changes to public repository
      run: |
        cd TataplayAuto
        git config --global user.name 'github-actions'
        git config --global user.email 'github-actions@github.com'
        git add ts.m3u
        git commit -m 'Update ts.m3u'
        git remote set-url origin https://x-access-token:${{ secrets.BINDAAS }}@github.com/Siva2webdev/TataplayAuto.git
        git push origin main  # Push to the main branch
